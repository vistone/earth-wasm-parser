syntax = "proto2";

package knowledge_graph;

import "devtools/protoshop/public/parsing_options/parsing_options.proto";
import "google/api/inclusion.proto";
import "knowledge/graph/util/datetime/datetime.proto";
import "net/proto2/bridge/proto/message_set.proto";
import "storage/datapol/annotations/proto/semantic_annotations.proto";
import "storage/graph/bfg/proto/livegraph_metadata.proto";
import "storage/graph/bfg/proto/policy_metadata.proto";
import "storage/graph/bfg/proto/spii_certification.proto";

option objc_class_prefix = "KLG";

message Triple {
    optional string sub = 1;
    optional string pred = 2;
    optional TripleObj obj = 17;
    optional bool is_negation = 19;
    
    repeated Provenance provenance = 16;
    message Provenance {
        optional string process = 1;
        optional string source_url = 2;
        optional int64 source_doc_id = 3;
        
        optional SourceCategory source_category = 4;
        enum SourceCategory {
            THIRD_PARTY = 1;
            CURATION = 2;
            PARTNER_FEED = 3;
            EXTRACTION = 4;
        }
        
        optional uint64 dataset_mid = 5;
        
        repeated RestrictionType restrictions = 6;
        enum RestrictionType {
            REQUIRES_CITATION = 1;
            REQUIRES_PCOUNSEL_REVIEW = 2;
            UNRESTRICTED_WITHIN_GOOGLE_NO_3P_USE = 3;
        }
        
        optional bool is_supporting_data = 7;
        optional int32 access_required = 8;
        optional storage_graph_bfg.SpiiCertification spii_certification = 9;
        optional string creator = 10;
        optional storage_graph_bfg.LivegraphProvenanceMetadata lg_metadata = 11;
        optional storage_graph_bfg.PolicyMetadata policy_metadata = 12;
        optional SourceContentReference source_content_reference = 13;
    }
    
    repeated QualifierSet qualifier_sets = 20;
    
    reserved 3 to 15, 18;
    
    extend .proto2.bridge.MessageSet {
        optional Triple message_set_extension = 75852567;
    }
}

message TripleObj {
    optional string locale = 11;
    
    oneof obj {
        string id_value = 1;
        string string_value = 2;
        string uri_value = 13;
        bool bool_value = 3;
        int64 int64_value = 4;
        uint64 uint64_value = 5;
        double double_value = 6;
        DateTimeProto datetime_value = 7;
        int64 duration_value = 8;
        uint64 s2cell_id = 9;
        Proto proto_value = 10;
        NestedStruct nested_struct_value = 12;
    }
    
    message Proto {
        optional string descriptor_full_name = 1;
        optional bytes data = 2;
    }
}

message NestedStruct {
    repeated PredicateObjs predicate_objs = 1;
    message PredicateObjs {
        optional string pred = 1;
        repeated TripleObj objs = 2;
    }
    
    reserved 10;
}

message TripleSet {
    repeated Triple triple = 1;
    
    extend .proto2.bridge.MessageSet {
        optional TripleSet message_set_extension = 75852568;
    }
}

message Qualifier {
    optional string pred = 1;
    optional TripleObj value = 2;
}

message QualifierSet {
    repeated Qualifier qualifiers = 1;
}

message SourceContentReference {
    optional string id_namespace = 1;
    optional string id = 2;
}
