syntax = "proto2";

package geo.earth.proto.earth_mate;

import "geo/earth/app/cpp/core/config_id.proto";
import "geo/earth/proto/contentcreation/content_editing_model.proto";
import "geo/earth/proto/documentnamespace.proto";
import "geo/earth/proto/user_industry.proto";
import "google/internal/earth/v1/shared.proto";
import "net/proto2/contrib/validator/annotations.proto";
import "storage/datapol/annotations/proto/semantic_annotations.proto";

option java_multiple_files = true;
option java_package = "com.google.geo.earth.proto";

message EarthMateRequestWrapper {
    optional EarthMateOrchestrationType orchestration_type = 2 [deprecated = true];
    optional EarthMateTechStack tech_stack = 3;
    
    oneof request_type {
        EarthMateQueryRequest query_request = 1;
        EarthMateAreaDescriptionRequest area_description_request = 4;
    }
}

message EarthMateQueryRequest {
    optional string query_string = 1;
    optional EarthMateAppContext app_context = 2;
    optional EarthMateChatContext chat_context = 3;
    optional string request_id = 4;
}

message EarthMateRateRequest {
    optional EarthMateRating rating = 1;
    optional string request_id = 2;
}

message EarthMateAreaDescriptionRequest {
    repeated .earth.document.protos.Polygon polygons = 1;
    optional EarthUserIndustry industry = 2;
    optional EarthMateAreaDescriptionFormat format = 3 [default = FORMAT_SHORT];
    optional string query_string = 4;
    optional EarthMateAppContext app_context = 5;
}

message EarthMateAppContext {
    optional CreationContext creation_context = 1;
    optional ViewContext view_context = 2;
    optional google.internal.earth.v1.ClientMetadata client_metadata = 3;
    optional .earth.ConfigId config_id = 4;
    optional string test_gaia_email = 5;
}

message CreationContext {
    optional int32 document_key = 1;
    optional string document_id = 2;
    optional string resource_key = 3;
    optional .earth.document.DocumentNamespace document_namespace = 4;
    repeated string selected_feature_ids = 5;
    optional .earth.document.protos.ModelVersion document_model_version = 6;
}

message ViewContext {
    optional LatLonBox viewport = 1;
    message LatLonBox {
        optional double north = 1;
        optional double south = 2;
        optional double east = 3;
        optional double west = 4;
    }
}

message EarthMateChatHistory {
    repeated EarthMateChatMessage messages = 1;
    message EarthMateChatMessage {
        optional string text = 1;
        optional bool is_bard = 2;
    }
}

message EarthMateChatContext {
    optional uint32 session_id = 1;
    optional string serialized_context = 2;
    optional EarthMateChatHistory chat_history = 3;
}

enum EarthMateOrchestrationType {
    ORCHESTRATION_TYPE_UNKNOWN = 0;
    ORCHESTRATION_TYPE_CHAIN = 1;
    ORCHESTRATION_TYPE_AGENT = 2;
}

enum EarthMateTechStack {
    STACK_UNKNOWN = 0;
    STACK_ONE_TWO = 1;
    STACK_ALS = 2;
}

enum EarthMateAreaDescriptionFormat {
    FORMAT_UNKNOWN = 0;
    FORMAT_SHORT = 1;
    FORMAT_LONG = 2;
    FORMAT_SHORT_AND_LONG = 3;
}

enum EarthMateRating {
    RATING_UNKNOWN = 0;
    RATING_THUMB_UP = 1;
    RATING_THUMB_DOWN = 2;
}
