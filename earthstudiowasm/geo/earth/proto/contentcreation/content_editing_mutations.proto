syntax = "editions";

package earth.document.protos;

import "geo/earth/proto/contentcreation/content_editing_model.proto";
import "storage/datapol/annotations/proto/semantic_annotations.proto";

option java_multiple_files = true;
option optimize_for = CODE_SIZE;
option java_package = "com.google.geo.earth.core.document";

message DataMutationSet {
    repeated DataMutation data_mutation = 1;
}

message DataMutation {
    oneof DataMutationType {
        AddFeature add_feature = 1;
        DeleteFeature delete_feature = 2;
        SetStyle set_style = 4;
        AddColumn add_column = 5;
        RemoveColumn remove_column = 6;
        UpdateColumn update_column = 7;
        AddFeatureMedia add_feature_media = 8;
        DeleteFeatureMedia delete_feature_media = 9;
        SetFeatureParent set_feature_parent = 10;
        SetFeatureIndex set_feature_index = 11;
        UpdateDocumentProperties update_document_properties = 12;
        UpdateFeatureProperties update_feature_properties = 13;
        UpdateStyleOptions update_style_options = 14;
    }
}

message MetadataMutationSet {
    repeated MetadataMutation metadata_mutation = 1;
}

message MetadataMutation {
    oneof MetadataMutationType {
        UpdateDocumentMetadata update_document_metadata = 3;
    }
}

message AddFeature {
    optional string parent_feature_id = 1;
    optional Feature feature = 8;
    repeated Feature feature_tree_continuation = 6;
    optional string deprecated_feature_id = 2;
    optional FeatureModelType deprecated_feature_model_type = 3 [default = FEATUREMODELTYPE_PLACEMARK];
    optional FeatureProperties deprecated_feature_properties = 4;
    repeated Feature deprecated_child_feature = 5;
    repeated Media deprecated_media = 7;
}

message DeleteFeature {
    optional string feature_id = 1;
    
    reserved 2, 3;
}

message UpdateFeatureProperties {
    optional string feature_id = 1;
    optional FeatureProperties feature_properties = 2;
}

message SetStyle {
    oneof StyleType {
        IndividualStyle individual_style = 1;
    }
}

message AddColumn {
    optional Column new_column = 1;
}

message RemoveColumn {
    optional string column_id = 1;
}

message UpdateColumn {
    optional string column_id = 1;
    optional string name = 2;
    optional string template_alias = 3;
    optional string template_default = 4;
}

message AddFeatureMedia {
    optional string feature_id = 1;
    optional Media media = 2;
    optional int32 media_index = 3 [default = -1];
}

message DeleteFeatureMedia {
    optional string feature_id = 1;
    optional MediaMutationId media_id = 2;
}

message SetFeatureParent {
    repeated string feature_id = 1;
    optional string parent_id = 5;
}

message SetFeatureIndex {
    optional string parent_feature_id = 1;
    repeated string feature_id = 2;
    optional int32 new_feature_index = 3;
    
    reserved 4;
}

message UpdateDocumentProperties {
    optional DocumentProperties properties = 1;
}

message UpdateDocumentMetadata {
    optional DocumentMetadata metadata = 1;
}

message UpdateStyleOptions {
    optional ContentStyleOptions style_options = 1;
}
